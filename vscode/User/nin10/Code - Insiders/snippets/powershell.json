{
    /*

    Snippets: Powershell

    Description:

    todo:
        - [ ] autocollect -> dotfiles_github


    Refs:
        dotfiles:
            $Env:userprofile\Documents\2020\MyModules_Github\VSCode-ConfigSnippets\snippet\powershell.json

        snippet pattern examples:
            <https://gist.github.com/ninmonkey/4fe8062d5ad1b2ad17e6f91a96984851>

        extension dir:
            $Env:UserProfile\.vscode\extensions\ms-vscode.powershell[-preview]-<version>\snippets\PowerShell.json
        see:
            https://code.visualstudio.com/docs/editor/userdefinedsnippets#_choice

    see also:

        https://github.com/PowerShell/vscode-powershell/blob/master/docs/community_snippets.md

    */
    /*
    Add one like
        $_.psobject.properties | %{ $_.Name, $_.value -join ' = ' }

    */
    "Snippet ‚á¢ PSObject Properties": {
        /*

        input:

            $x

        output:

            $x.psobject.properties | ForEach-Object {
               $_.TypeNameOfValue, $_.Name, $_.value -join ' = '
            }

        */
        "prefix": "listProps : PSObject.properties : üêí",
        "body": [
            // $_.TypeNameOfValue, $_.Name, $_.value -join ' = '
            "${TM_SELECTED_TEXT}.psobject.properties | ForEach-Object {",
            // "   $$_.${2:$$_.$$_.Name, $$_.value -join ' = '}",
            "   ${2:$$_.TypeNameOfValue, $$_.Name, $$_.value -join ' = '}",
            "}"
        ],
        "description": "inline definition to enumrate over '$_.PSObject.Properties' "
    },
    "herestring variables": {
        "prefix": "hereStr : Variable üêí",
        "body": [
            "@\"",
            "${1:$TM_SELECTED_TEXT}",
            "\"@",
            "${0}"
        ],
        "description": "Interpolated Here-string. Intended  to be hotkey only, when there's a selection to wrap "
    },
    "herestring literal": {
        "prefix": "hereStr : Literal üêí Literal Herestring",
        "body": [
            "@'",
            "${1:$TM_SELECTED_TEXT}",
            "'@",
            "${0}"
        ],
        "description": "Literals Here-String. Intended  to be hotkey only, when there's a selection to wrap"
    },
    "Help ‚á¢ Comment Based": {
        //was not getting priority, since snippet ext:  "ninParameter [Parameter] : Basic",
        "prefix": "DocString Help Docstring üêí",
        "description": "nin ‚Åû The important docstring attributes. Selected Text Populates Synopis",
        "body": [
            "<#",
            ".synopsis",
            "    ${1:${TM_SELECTED_TEXT:Short Description}}",
            ".description",
            "    Long description",
            ".example",
            "    PS> .",
            ".inputs",
            "    Summary of Pipeline Inputs",
            ".outputs",
            "    None",
            ".notes",
            "    General notes",
            ".link",
            "    command",
            "#>",
            "${0}",
        ],
    },
    // "CmdletBinding()": {
    //     "prefix": "WIP -- [CmdletBinding()]",
    //     "description": "nin ‚Åû CmdletBinding with initial params",
    "Function ‚á¢ Cmdlet": {
        "prefix": "Function ‚á¢ [CmdletBinding] üêí",
        "description": "Defaults for a  new functionüêí",
        "body": [
            "function ${1:Get-Foo} {",
            "    <#",
            "    .synopsis",
            "        ${2:Stuff}",
            "    .description",
            "        ${3:Desc}",
            "    .outputs",
            "    ",
            "    #>",
            "    [CmdletBinding(PositionalBinding=\\$false)]",
            "    param(",
            "        ${4}",
            "    )",
            "    ",
            "    begin {}",
            "    process {",
            "       ${0}", // to use selected text, see: "Function ‚á¢ Tiny"
            "    # todo: always wrap CmdletExceptionWrapper: From Sci",
            "    }",
            "    end {}",
            "}"
        ]
    },
    "Func ‚á¢ Tiny | Function üêí": {
        "prefix": "Function ‚á¢ Tiny | Function { .. } üêí",
        "description": "Minimal defaults | Supports selected text.",
        "body": [
            "function ${1:Get-Foo} {",
            "    <#",
            "    .synopsis",
            "        ${2:Stuff}",
            "    .description",
            "        .",
            "    ",
            "    #>",
            "    [CmdletBinding(PositionalBinding=\\$false)]",
            "    param(",
            "        ${0}",
            "    )",
            "    ${4:${TM_SELECTED_TEXT}}", // works.. not sure whether I want to use selection
            "}"
        ]
    },
    "CalculatedProperty": {
        "prefix": "Calculated-Property ‚á¢ SingleLine üêí",
        "body": [
            "@{name='${1:PropertyName}';expression={${2:${TM_SELECTED_TEXT:\\$_.PropertyValue}}}}$0"
        ],
        "description": "nin ‚Åû a CalculatedProperty on a Single Line",
    },
    "CalculatedProperty: Multiline": {
        "prefix": "Calculated-Property ‚á¢ MultiLine üêí",
        "body": [
            "@{",
            "    Name = '${1:PropertyName}'",
            "    Expression = {",
            "        ${2:${TM_SELECTED_TEXT:\\$_.PropertyValue}}",
            "   }",
            "}",
            "$0"
        ],
        "description": "nin ‚Åû a CalculatedProperty using multiple lines",
    },
    "IfShouldProcess": {
        "prefix": "IfShouldProcess : <Selection> üêí",
        "description": "nin ‚Åû Creates ShouldProcess block from your Selection",
        "body": [
            "if (\\$PSCmdlet.ShouldProcess(\"${1:Target}\", \"${2:Operation}\")) {",
            "    ${0:$TM_SELECTED_TEXT}",
            "}"
        ],
    },
    "Parameter ‚á¢ Switch": {
        "prefix": "Param ‚á¢ [Switch] üêí",
        "description": "nin ‚Åû adds a [switch] parameter",
        "body": [
            "# ${1:Docstring}",
            "[Parameter()][switch]\\$${0}"
        ]
    },
    "Parameter ‚á¢ Basic": {
        "description": "nin ‚Åû A basic [Parameter()]",
        "prefix": "Parameter üêí default",
        "body": [
            "# ${1:Docstring}",
            "[Parameter(${2:Mandatory, Position=0})]",
            "[${3:object}]$${4:ParameterName}${0}",
        ],
    },
    "Parameter: Completer ‚á¢ ValidateSet": {
        "prefix": "Param ‚á¢ Completer | [ValidateSet] üêí",
        "description": "nin ‚Åû Autocompleter parameter from a static list using ValidateSet()",
        "body": [
            "# ${1:Docstring}",
            "[ValidateSet(${2:'a', 'b'})]",
            "[Parameter(${3:Mandatory, Position=0})]",
            "[string[]]$${4:ParameterName}",
            "${0}"
        ],
    },
    "Switch ‚á¢ ParameterSetNameSwitch": {
        "prefix": "Switch ‚á¢ $PSCmdlet.ParameterSetName { .. } : üêí",
        "description": "nin ‚Åû Template for a switch with ParameterSetNames",
        "body": [
            "switch (\\$PSCmdlet.ParameterSetName) {",
            "    ${1:'x'} {",
            "        ${2}",
            "        break",
            "    }",
            "    ${0}",
            "    default {",
            "        throw \"Unhandled ParameterSet: $(\\$PSCmdlet.ParameterSetName)\"",
            "    }",
            "}",
        ]
    },
    "Web ‚á¢ Invoke-RestMethod": {
        "prefix": "Web ‚á¢ Invoke-RestMethod üêí",
        "description": "nin ‚Åû Invoke-RestMethod | template saves response data",
        "body": [
            "\\$splat_irm = @{",
            "    Uri                     = '${1:$TM_SELECTED_TEXT}'",
            "    Body                    = @{",
            "        ${2}",
            "    }",
            "    # Form = @{}",
            "    Method                  = 'Get'",
            "    SessionVariable         = 'sess_var'",
            "    StatusCodeVariable      = 'status_var'",
            "    ResponseHeadersVariable = 'response_var'",
            "    # ContentType = ''",
            "    # TimeoutSec = 0",
            "    # Token = 'foo'",
            "    # Authentication = 'OAuth'",
            "    Headers                 = @{}",
            "}",
            "",
            "\\$Response ??= Invoke-RestMethod @splat_irm${0}",
        ],
    },
}